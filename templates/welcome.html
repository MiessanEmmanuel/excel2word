{% extends "layout/layout.html" %}

{% block content %}

    <div class="text-center mb-12">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">Convertisseur Excel vers Documents Word</h1>
        <p class="text-gray-600 max-w-2xl mx-auto">
            Importez votre fichier Excel, visualisez et modifiez les données, puis générez des documents Word
            individuels pour chaque ligne.
        </p>
    </div>

    <div class="flex flex-col md:flex-row gap-8">
        <!-- Upload section -->
        <div class="bg-white rounded-lg shadow-md p-6 flex-1">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Importer un fichier Excel</h2>

            <form action="{{url_for('uploadFile')}}" method="post" enctype="multipart/form-data" class="mb-6">
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors duration-300 cursor-pointer bg-gray-50"
                     id="drop-area">
                    <input type="file" name="excel_file" id="file-input" accept=".xlsx,.xls" class="hidden">
                    <div class="mb-4">
                        <i class="fas fa-file-excel text-5xl text-gray-400"></i>
                    </div>
                    <p class="text-gray-600 mb-2">Glissez votre fichier Excel ici</p>
                    <p class="text-gray-500 text-sm mb-4">ou</p>
                    <button type="button" id="browse-button"
                            class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md transition duration-300">
                        Parcourir les fichiers
                    </button>
                    <p class="text-gray-500 text-xs mt-3">Formats acceptés: .xlsx, .xls</p>
                </div>
                <div id="file-name" class="mt-4 text-center font-medium text-gray-700 hidden"></div>
                <div class="mt-6 text-center">
                    <button type="submit"
                            class="bg-green-600 hover:bg-green-700 text-white py-2 px-6 rounded-md transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
                            id="upload-button" disabled>
                        Importer et continuer
                    </button>
                </div>
            </form>
        </div>

        <!-- Features section -->
        <div class="bg-white rounded-lg shadow-md p-6 flex-1">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Fonctionnalités</h2>

            <div class="space-y-6">
                <div class="flex items-start">
                    <div class="bg-blue-100 p-2 rounded-full mr-4">
                        <i class="fas fa-table text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-800">Visualisation des données</h3>
                        <p class="text-gray-600 text-sm">Affichez les données de votre fichier Excel sous forme de
                            tableau interactif</p>
                    </div>
                </div>

                <div class="flex items-start">
                    <div class="bg-blue-100 p-2 rounded-full mr-4">
                        <i class="fas fa-edit text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-800">Modification des entrées</h3>
                        <p class="text-gray-600 text-sm">Modifiez chaque ligne selon vos besoins avant de générer les
                            documents</p>
                    </div>
                </div>

                <div class="flex items-start">
                    <div class="bg-blue-100 p-2 rounded-full mr-4">
                        <i class="fas fa-file-word text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-800">Génération de documents Word</h3>
                        <p class="text-gray-600 text-sm">Créez un document Word pour chaque ligne du tableau</p>
                    </div>
                </div>

                <div class="flex items-start">
                    <div class="bg-blue-100 p-2 rounded-full mr-4">
                        <i class="fas fa-download text-blue-600"></i>
                    </div>
                    <div>
                        <h3 class="font-medium text-gray-800">Téléchargement flexible</h3>
                        <p class="text-gray-600 text-sm">Téléchargez des documents individuels ou tous les documents en
                            une archive ZIP</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- How it works section -->
    <div class="mt-12">
        <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Comment ça fonctionne</h2>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="bg-white p-5 rounded-lg shadow text-center">
                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="font-bold">1</span>
                </div>
                <h3 class="font-medium text-gray-800 mb-2">Importez</h3>
                <p class="text-gray-600 text-sm">Téléversez votre fichier Excel</p>
            </div>

            <div class="bg-white p-5 rounded-lg shadow text-center">
                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="font-bold">2</span>
                </div>
                <h3 class="font-medium text-gray-800 mb-2">Visualisez</h3>
                <p class="text-gray-600 text-sm">Consultez les données dans un tableau</p>
            </div>

            <div class="bg-white p-5 rounded-lg shadow text-center">
                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="font-bold">3</span>
                </div>
                <h3 class="font-medium text-gray-800 mb-2">Modifiez</h3>
                <p class="text-gray-600 text-sm">Ajustez les données si nécessaire</p>
            </div>

            <div class="bg-white p-5 rounded-lg shadow text-center">
                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="font-bold">4</span>
                </div>
                <h3 class="font-medium text-gray-800 mb-2">Générez</h3>
                <p class="text-gray-600 text-sm">Téléchargez vos documents Word</p>
            </div>
        </div>
    </div>


{% endblock %}

{% block script %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');
        const browseButton = document.getElementById('browse-button');
        const uploadButton = document.getElementById('upload-button');
        const fileName = document.getElementById('file-name');

        // Handle click on the browse button
        browseButton.addEventListener('click', function () {
            fileInput.click();
        });

        // Handle file selection
        fileInput.addEventListener('change', function () {
            if (fileInput.files.length > 0) {
                updateFileInfo(fileInput.files[0]);
            }
        });

        // Handle drag and drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.classList.add('border-blue-500', 'bg-blue-50');
        }

        function unhighlight() {
            dropArea.classList.remove('border-blue-500', 'bg-blue-50');
        }

        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;

            if (files.length > 0) {
                fileInput.files = files;
                updateFileInfo(files[0]);
            }
        }

        function updateFileInfo(file) {
            // Check if the file is an Excel file
            const validTypes = ['.xlsx', '.xls', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'];
            const fileExtension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();

            if (!validTypes.includes(fileExtension) && !validTypes.includes(file.type)) {
                alert('Veuillez sélectionner un fichier Excel valide (.xlsx ou .xls)');
                fileInput.value = '';
                return;
            }

            fileName.textContent = file.name;
            fileName.classList.remove('hidden');
            uploadButton.disabled = false;
        }
    });
</script>
{% endblock %}